!function(e){"use strict";var t=[],a=!1,r=!0;redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{},redux.field_objects.typography.init=function(s){s=e.redux.getSelector(s,"typography"),e(s).each(function(){var s=e(this),o=s;s.hasClass("redux-field-container")||(o=s.parents(".redux-field-container:first")),o.is(":hidden")||(void 0===redux.field_objects.pro&&(r=!1),s.each(function(){e(this).find(".redux-typography-container").each(function(){var s,o,i,p,d,n,y=e(this),l=y,h=e(this).find(".redux-typography-family"),g=h.data("value"),u=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),f=e("#"+u+" .redux-typography-google").val(),c=[],x=[],v=e("#"+u+" .redux-typography-font-family").data("user-fonts");if(y.hasClass("redux-field-container")||(l=y.parents(".redux-field-container:first")),!l.is(":hidden")&&l.hasClass("redux-field-init")){if(l.removeClass("redux-field-init"),void 0===g?h=e(this):""!==g&&e(h).val(g),v=v?1:0,f=f?1:0,void 0!==redux.customfonts&&c.push(redux.customfonts),void 0!==redux.typekitfonts&&c.push(redux.typekitfonts),void 0!==redux.stdfonts&&0===v&&c.push(redux.stdfonts),1===v){for(s in redux.optName.typography[u])if(redux.optName.typography[u].hasOwnProperty(s))for(i in o=redux.optName.typography[u].std_font)o.hasOwnProperty(i)&&x.push({id:i,text:i,"data-google":"false"});p={text:"Standard Fonts",children:x},c.push(p)}(1===f||!0===f&&void 0!==redux.googlefonts)&&c.push(redux.googlefonts),n=c,d=e(this).find(".redux-typography-family").data("value"),e(this).find(".redux-typography-family").addClass("ignore-change"),e(this).find(".redux-typography-family").select2({data:n}),e(this).find(".redux-typography-family").val(d).trigger("change"),e(this).find(".redux-typography-family").removeClass("ignore-change"),y.find(".redux-typography-family").hasClass("redux-typography-family")||y.find(".redux-typography-style").select2(),e(this).find(".redux-typography-align").select2(),e(this).find(".redux-typography-family-backup").select2(),e(this).find(".redux-typography-transform").select2(),e(this).find(".redux-typography-font-variant").select2(),e(this).find(".redux-typography-decoration").select2(),e(this).find(".redux-insights-data-we-collect-typography").on("click",function(t){t.preventDefault(),e(this).parent().find(".description").toggle()}),redux.field_objects.typography.select(h,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var s,o,i=e(this).attr("id"),p=e("#"+i);e(this).hasClass("redux-typography-family")?p.val()&&(o=(s=e(this).select2("data"))?s[0].text:null,p.data("value",o),t=s[0],a=!0,redux.field_objects.typography.select(p,!0,!1,o,!0)):(r=p.val(),p.data("value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(p.find('option[selected="selected"]').removeAttr("selected"),p.find('option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&p.siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),e(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),r&&(redux.field_objects.pro.typography.fieldChange(e(this)),redux.field_objects.pro.typography.colorPicker(e(this))),e(this).find(".redux-typography-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(){var t,a,r=e(this).data("select2").options;r.set("disabled",!0),setTimeout(function(){r.set("disabled",!1)},1),t=e(this).attr("id"),(a=e("#"+t)).data("value",""),e(this).hasClass("redux-typography-family")?(e(this).find(".redux-typography-family").addClass("ignore-change"),e(this).val(null).trigger("change"),e(this).find(".redux-typography-family").removeClass("ignore-change"),redux.field_objects.typography.select(a,!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+t+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&a.siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&(e(this).find(".redux-typography-family-backup").addClass("ignore-change"),a.val(null).trigger("change"),e(this).find(".redux-typography-family-backup").removeClass("ignore-change")),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(e(this)),window.onbeforeunload=null,l.removeClass("redux-field-init")}})}))})},redux.field_objects.typography.updates=function(t){t.find(".update-google-fonts").bind("click",function(a){var r=e(this).data("action"),s=e(this).parent().parent(),o=s.attr("data-nonce");return s.find("p").text(redux_typography_ajax.update_google_fonts.updating),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.updating),s.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),e.ajax({type:"post",dataType:"json",url:redux_typography_ajax.ajaxurl,data:{action:"redux_update_google_fonts",nonce:o,data:r},error:function(e){var a;console.log(e),s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),(a=e.error)&&(a=': "'+a+'"'),s.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",r).replace("|msg",a)),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(t)},success:function(a){var o;console.log(a),"success"===a.status?(s.find("p").html(redux_typography_ajax.update_google_fonts.success),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.success),s.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),e(".redux-update-google-fonts").not(".notice-success").remove()):(s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),(o=a.error)&&(o=': "'+o+'"'),s.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",r).replace("|msg",o)),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(t))}}),a.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&(a+=1);return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&!1!==e&&0!==e&&("true"===e||"1"===e||!0===e||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";return""!==e&&(e=e.replace("#",""),t=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=128?"#444444":"#ffffff"),t},redux.field_objects.typography.select=function(s,o,i,p,d){var n,y,l,h,g,u,f,c,x,v,m,b,_,C,j,w,k,z,O,I=!1,B="",S='<option value=""></option>',N="",P={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"};void 0===(n=e(s).parents(".redux-container-typography:first").data("id"))&&(n=e(s).data("id")),y=e("#"+n),(l=e("#"+n+"-family").val())||(l=null),p&&(l=p),g=y.find("select.redux-typography-family-backup").val(),u=y.find(".redux-typography-size").val(),f=y.find(".redux-typography-height").val(),c=y.find(".redux-typography-word").val(),x=y.find(".redux-typography-letter").val(),v=y.find("select.redux-typography-align").val(),m=y.find("select.redux-typography-transform").val(),b=y.find("select.redux-typography-font-variant").val(),_=y.find("select.redux-typography-decoration").val(),C=y.find("select.redux-typography-style").val(),j=y.find("select.redux-typography-subsets").val(),w=y.find(".redux-typography-color").val(),k=y.data("units"),!0===a?(h=redux.field_objects.typography.makeBool(t["data-google"]),y.find(".redux-typography-google-font").val(h)):h=redux.field_objects.typography.makeBool(y.find(".redux-typography-google-font").val()),d&&(y.hasClass("typography-initialized")||(C=y.find("select.redux-typography-style").data("value"),j=y.find("select.redux-typography-subsets").data("value"),""!==C&&(C=String(C)),void 0!==typeof j&&(j=String(j))),void 0===redux.fonts.google&&(h=!1),!0===h&&l in redux.fonts.google?B=redux.fonts.google[l]:void 0!==redux.fonts.typekit&&l in redux.fonts.typekit?(I=!0,B=redux.fonts.typekit[l]):B=P,e(s).hasClass("redux-typography-subsets")&&y.find("input.typography-subsets").val(j),e(s).hasClass("redux-typography-family")?(!0===h?(e.each(B.variants,function(e,t){t.id===C||1===redux.field_objects.typography.size(B.variants)?(N=' selected="selected"',C=t.id):N="",S+='<option value="'+t.id+'"'+N+">"+t.name.replace(/\+/g," ")+"</option>"}),i&&y.find(".redux-typography-style").select2("destroy"),y.find(".redux-typography-style").html(S).select2(),N="",S='<option value=""></option>',e.each(B.subsets,function(e,t){j===t.id||1===redux.field_objects.typography.size(B.subsets)?(N=' selected="selected"',j=t.id,y.find("input.typography-subsets").val(j)):N="",S+='<option value="'+t.id+'"'+N+">"+t.name.replace(/\+/g," ")+"</option>"}),i&&y.find(".redux-typography-subsets").select2("destroy"),y.find(".redux-typography-subsets").html(S).select2({width:"100%"}),y.find(".redux-typography-subsets").parent().fadeIn("fast"),y.find(".typography-family-backup").fadeIn("fast")):!0===I?(e.each(B.variants,function(e,t){C===t.id||1===redux.field_objects.typography.size(B.variants)?(N=' selected="selected"',C=t.id):N="",S+='<option value="'+t.id+'"'+N+">"+t.name.replace(/\+/g," ")+"</option>"}),y.find(".redux-typography-style").select2("destroy"),y.find(".redux-typography-style").html(S).select2(),y.find(".redux-typography-subsets").parent().fadeOut("fast"),y.find(".typography-family-backup").fadeOut("fast")):y.find(".redux-typography-style")&&(e.each(P,function(e,t){C===e||"normal"===e?(N=' selected="selected"',y.find(".typography-style select2-selection__rendered").text(t)):N="",S+='<option value="'+e+'"'+N+">"+t.replace("+"," ")+"</option>"}),i&&y.find(".redux-typography-style").select2("destroy"),y.find(".redux-typography-style").html(S).select2()),y.find(".redux-typography-font-family").val(l)):e(s).hasClass("redux-typography-family-backup")&&""!==g?y.find(".redux-typography-font-family-backup").val(g):(B=P)&&(e.each(B,function(e,t){C===e||"normal"===e?(N=' selected="selected"',y.find(".typography-style select2-selection__rendered").text(t)):N="",S+='<option value="'+e+'"'+N+">"+t.replace("+"," ")+"</option>"}),i&&y.find(".redux-typography-style").select2("destroy"),y.find(".redux-typography-style").html(S).select2(),y.find(".redux-typography-subsets").parent().fadeOut("fast"),y.find(".typography-family-backup").fadeOut("fast"))),d&&(y.find(".redux-typography-style").addClass("ignore-change"),0===y.find("select.redux-typography-style option[value='"+C+"']").length?(C="",y.find("select.redux-typography-style").val("").trigger("change")):"400"===C&&y.find("select.redux-typography-style").val(C).trigger("change"),y.find(".redux-typography-style").removeClass("ignore-change"),0===y.find("select.redux-typography-subsets option[value='"+j+"']").length&&(j="",y.find(".redux-typography-style").addClass("ignore-change"),y.find("select.redux-typography-subsets").val("").trigger("change"),y.find("input.typography-subsets").val(j),y.find(".redux-typography-style").removeClass("ignore-change"))),e("."+("style_link_"+n)).remove(),null!==l&&"inherit"!==l&&y.hasClass("typography-initialized")&&(z=l.replace(/\s+/g,"+"),!0===h?(O=z,C&&""!==C&&(O+=":"+C.replace(/\-/g," ")),j&&""!==j&&(O+="&subset="+j),!1===a&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[O]}}),y.find(".redux-typography-google").val(!0)):y.find(".redux-typography-google").val(!1)),void 0!==C&&-1!==C.indexOf("italic")?(y.find(".typography-preview").css("font-style","italic"),y.find(".typography-font-style").val("italic"),C=C.replace("italic","")):(y.find(".typography-preview").css("font-style","normal"),y.find(".typography-font-style").val("")),y.find(".typography-font-weight").val(C),Boolean(y.find(".redux-typography-height").data("allow-empty"))||f||(f=u),""===u||void 0===u?y.find(".typography-font-size").val(""):y.find(".typography-font-size").val(u+k),""===f||void 0===f?y.find(".typography-line-height").val(""):y.find(".typography-line-height").val(f+k),""===c||void 0===c?y.find(".typography-word-spacing").val(""):y.find(".typography-word-spacing").val(c+k),""===x||void 0===x?y.find(".typography-letter-spacing").val(""):y.find(".typography-letter-spacing").val(x+k),r&&redux.field_objects.pro.typography.select(n),y.hasClass("typography-initialized")&&(0===y.find(".typography-preview").data("preview-size")&&y.find(".typography-preview").css("font-size",u+k),y.find(".typography-preview").css({"font-weight":C,"text-align":v,"font-family":l+", sans-serif"}),"none"===l&&""===l&&y.find(".typography-preview").css("font-family","inherit"),y.find(".typography-preview").css({"line-height":f+k,"word-spacing":c+k,"letter-spacing":x+k}),w&&y.find(".typography-preview").css("color",w),r&&redux.field_objects.typography.previewShadow(n),y.find(".typography-style select2-selection__rendered").text(y.find(".redux-typography-style option:selected").text()),y.find(".typography-script select2-selection__rendered").text(y.find(".redux-typography-subsets option:selected").text()),v&&y.find(".typography-preview").css("text-align",v),m&&y.find(".typography-preview").css("text-transform",m),b&&y.find(".typography-preview").css("font-variant",b),_&&y.find(".typography-preview").css("text-decoration",_),y.find(".typography-preview").slideDown()),y.hasClass("typography-initialized")||y.addClass("typography-initialized"),a=!1,o||redux_change(s)}}(jQuery);